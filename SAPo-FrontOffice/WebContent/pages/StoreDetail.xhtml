<?xml version="1.0" encoding="UTF-8" ?>
<ui:composition template="/WEB-INF/templates/Layout.xhtml"
	xmlns="http://www.w3.org/1999/xhtml"
	xmlns:f="http://java.sun.com/jsf/core" 
	xmlns:h="http://java.sun.com/jsf/html"
	xmlns:ui="http://java.sun.com/jsf/facelets"
	xmlns:p="http://primefaces.org/ui">
	<ui:define name="title">
		<h:outputText value="Login" />
		<h:outputStylesheet library="styles" name="storeDetails.css" />
	</ui:define>
	<ui:define name="Principal">
		<h:form id="form" prependId="false">
			<p:growl id="msgs" showDetail="true"/>
			<h:outputText value="#{storeDetailBB.store.name}"> </h:outputText>
			<h:commandButton id="buttonCreateBuyList" value="Nueva lista de compras" action="#{storeDetailBB.createBuyList}"/>
			<h:commandButton id="buttonCreateCategory" value="Nuevo Categoria" action="#{storeDetailBB.createCategory}"/>
			<h:commandButton id="buttonCreateProduct" value="Nueva Producto" action="#{storeDetailBB.createProduct}"/>
			
			<p:tabView>
		        <p:tab title="Productos">
		            <p:dataTable id="listProducts" var="product" value="#{storeDetailBB.products}"
						editable="true" style="margin-bottom:20px" emptyMessage="No existen productos">
						
						<p:ajax event="rowEdit" listener="#{storeDetailBB.onRowProductEdit}" update=":form:msgs" />
						<p:ajax event="rowEditCancel" listener="#{storeDetailBB.onRowProductCancel}" update=":form:msgs" />

						<p:column headerText="Nombre">
							<p:cellEditor>
								<f:facet name="output">
									<h:outputText value="#{product.name}" />
								</f:facet>
								<f:facet name="input">
									<p:inputText id="modelInput" value="#{product.name}"
										style="width:100%" />
								</f:facet>
							</p:cellEditor>
						</p:column>
						
						<p:column headerText="Stock">
							<p:cellEditor>
								<f:facet name="output">
									<h:outputText value="#{product.stock.cantidad}" />
								</f:facet>
								<f:facet name="input">
										<p:spinner value="#{product.stock.cantidad}" label="Stock" min="0" />
								</f:facet>
							</p:cellEditor>
						</p:column>

						<p:column headerText="Precio de compra">
							<p:cellEditor>
								<f:facet name="output">
									<h:outputText value="$#{product.stock.precioCompra}" />
								</f:facet>
								<f:facet name="input">
									<p:spinner value="#{product.stock.precioCompra}" prefix="$" min="0" label="Precio de compra"  />
								</f:facet>
							</p:cellEditor>
						</p:column>

						<p:column headerText="Precio de venta">
							<p:cellEditor>
								<f:facet name="output">
									<h:outputText value="$#{product.stock.precioVenta}" />
								</f:facet>
								<f:facet name="input">
									<p:spinner value="#{product.stock.precioVenta}" prefix="$" min="0" label="Precio de venta"  />
								</f:facet>
							</p:cellEditor>
						</p:column>

						<p:column style="width:32px">
							<p:rowEditor />
						</p:column>
						
						<p:column style="width:32px">
							<h:commandLink id="ShowProductDetail" value="Info" action="#{storeDetailBB.showProduct}"/>
						</p:column>
					</p:dataTable>
		        </p:tab>
		        <p:tab title="Listas de compras">
		            <p:accordionPanel value="#{storeDetailBB.buyLists}" var="list">
				        <p:tab title="#{lsit.name} - fecha">
				        	<h:outputText value="#{list.description}"> </h:outputText>
				            <p:dataTable id="listBuyLists" var="elem" value="#{list.elements}"
								editable="true" style="margin-bottom:20px" emptyMessage="La lista esta vacia">
								<p:ajax event="rowEdit" listener="#{storeDetailBB.onRowBuyListEdit}" update=":form:msgs" />
								<p:ajax event="rowEditCancel" listener="#{storeDetailBB.onRowBuyListCancel}" update=":form:msgs" />
								<p:column headerText="Producto">
									<p:cellEditor>
										<f:facet name="output">
											<h:outputText value="#{elem.product.name}" />
										</f:facet>
										<f:facet name="input">
											<p:inputText id="modelInput" value="#{elem.product.name}"
												style="width:100%" />
										</f:facet>
									</p:cellEditor>
								</p:column>
								<p:column headerText="Cantidad">
									<p:cellEditor>
										<f:facet name="output">
											<h:outputText value="#{elem.quantity}" />
										</f:facet>
										<f:facet name="input">
												<p:spinner value="#{elem.quantity}" label="Cantidad" min="0" />
										</f:facet>
									</p:cellEditor>
								</p:column>
								<p:column style="width:32px">
									<p:rowEditor />
								</p:column>
							</p:dataTable>
				        </p:tab>
				    </p:accordionPanel>
		        </p:tab>
		    </p:tabView>
			
		</h:form>
	</ui:define>
</ui:composition>